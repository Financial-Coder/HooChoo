[phases.setup]
nixPkgs = ['nodejs_20', 'openssl']

[phases.install]
cmds = ['npm ci']

[phases.build]
cmds = ['DATABASE_URL="${DATABASE_URL:-postgresql://dummy}" npx prisma generate', 'npm run build']

[start]
cmd = 'npx prisma db push --accept-data-loss && node dist/main'
